#!/usr/bin/env node

const args = require('args');
const chalk = require('chalk');
const fs = require('fs');
const path = require('path');
const glob = require('glob');

const lint = require('../index');
const { outputFormatter } = lint;

const unique = list =>
  list.filter((item, index, list) => list.indexOf(item) === index);

args
  .option('port', 'The port on which the app will be running', 3000)
  .option('debug', 'Show debug log', false)
  .command('serve', 'Serve your static site', ['s']);

const flags = args.parse(process.argv);

if (flags.debug) {
  console.log(`Debug: flags ${JSON.stringify(flags)}`);
}

const list = [];
const files = args.sub;
if (!files.length) {
  console.log(chalk.red('Error: At least one markdown file is needed.'));
}

files.forEach(filepath => list.push(...glob.sync(filepath)));
const lintFiles = unique(list);

if (flags.debug) {
  console.log(`Debug: lint files '${lintFiles.join(', ')}'`);
}

// outputFormatter(lint('./test/**'));
